---
layout: default
title: Topics Index
permalink: /topics/
---

<h1>Topics</h1>

{% comment %}Combine all assignments from all _data files{% endcomment %}
{% assign all_assignments = "" | split: "" %}
{% for pair in site.data %}
  {% assign data_value = pair[1] %}
  {% if data_value.assignments %}
    {% assign all_assignments = all_assignments | concat: data_value.assignments %}
  {% endif %}
{% endfor %}

{% comment %}Precompute links HTML for each topic{% endcomment %}
{% assign topic_html = {} %}

{% for assignment in all_assignments %}
  {% for tid in assignment.topics %}
    {% assign current_html = topic_html[tid] | default: "" %}
    {% for pair in site.data %}
      {% if pair[1].works %}
        {% for work in pair[1].works %}
          {% for structure_item in work.structure %}
            {% assign children = structure_item.children | default: empty %}
            {% for child in children %}
              {% if child.id == assignment.section_id %}
                {% assign link = "/works/" | append: work.id | append: "/" | relative_url %}
                {% assign current_html = current_html | append: "<li><a href='" | append: link | append: "'><em>" | append: work.title | append: "</em> â€” " | append: child.type | append: " " | append: child.number | append: ": " | append: child.title.en | append: "</a></li>" %}
              {% endif %}
            {% endfor %}
          {% endfor %}
        {% endfor %}
      {% endif %}
    {% endfor %}
    {% assign topic_html = topic_html | merge: { tid: current_html } %}
  {% endfor %}
{% endfor %}


{% comment %}Flattened rendering - 4 levels{% endcomment %}
{% for topic in site.data.topics_definitions.topics %}
  <h2 id="{{ topic.id }}">{{ topic.name }}</h2>
  {% if topic.description %}<p>{{ topic.description }}</p>{% endif %}
  <p style="color: purple; font-size: small;">DEBUG: id={{ topic.id }}, children={{ topic.children | default: empty | size }}, links={{ topic_html[topic.id] | default: "" | split: "<li>" | size | minus: 1 }}</p>
  {% if topic_html[topic.id] != "" %}<ul>{{ topic_html[topic.id] | raw }}</ul>{% endif %}

  {% assign children1 = topic.children | default: empty %}
  {% for sub1 in children1 %}
    <h3 id="{{ sub1.id }}" style="margin-left: 20px;">{{ sub1.name }}</h3>
    {% if sub1.description %}<p style="margin-left: 20px;">{{ sub1.description }}</p>{% endif %}
    <p style="margin-left: 20px; color: purple; font-size: small;">DEBUG: id={{ sub1.id }}, children={{ sub1.children | default: empty | size }}, links={{ topic_html[sub1.id] | default: "" | split: "<li>" | size | minus: 1 }}</p>
    {% if topic_html[sub1.id] != "" %}<ul style="margin-left: 20px;">{{ topic_html[sub1.id] | raw }}</ul>{% endif %}

    {% assign children2 = sub1.children | default: empty %}
    {% for sub2 in children2 %}
      <h4 id="{{ sub2.id }}" style="margin-left: 40px;">{{ sub2.name }}</h4>
      {% if sub2.description %}<p style="margin-left: 40px;">{{ sub2.description }}</p>{% endif %}
      <p style="margin-left: 40px; color: purple; font-size: small;">DEBUG: id={{ sub2.id }}, children={{ sub2.children | default: empty | size }}, links={{ topic_html[sub2.id] | default: "" | split: "<li>" | size | minus: 1 }}</p>
      {% if topic_html[sub2.id] != "" %}<ul style="margin-left: 40px;">{{ topic_html[sub2.id] | raw }}</ul>{% endif %}

      {% assign children3 = sub2.children | default: empty %}
      {% for sub3 in children3 %}
        <h5 id="{{ sub3.id }}" style="margin-left: 60px;">{{ sub3.name }}</h5>
        {% if sub3.description %}<p style="margin-left: 60px;">{{ sub3.description }}</p>{% endif %}
        <p style="margin-left: 60px; color: purple; font-size: small;">DEBUG: id={{ sub3.id }}, children={{ sub3.children | default: empty | size }}, links={{ topic_html[sub3.id] | default: "" | split: "<li>" | size | minus: 1 }}</p>
        {% if topic_html[sub3.id] != "" %}<ul style="margin-left: 60px;">{{ topic_html[sub3.id] | raw }}</ul>{% endif %}
      {% endfor %}

    {% endfor %}
  {% endfor %}
{% endfor %}
